<Window x:Class="FajrApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FajrApp"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        SizeToContent="Width"
        Height="52"
        ResizeMode="NoResize">
    
    <Window.Resources>
        <Style x:Key="WidgetTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Variable, Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="PrayerNameStyle" TargetType="TextBlock" BasedOn="{StaticResource WidgetTextStyle}">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Opacity" Value="0.95"/>
        </Style>
        
        <Style x:Key="TimeStyle" TargetType="TextBlock" BasedOn="{StaticResource WidgetTextStyle}">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Opacity" Value="0.95"/>
        </Style>
        
        <Style x:Key="CountdownLabelStyle" TargetType="TextBlock" BasedOn="{StaticResource WidgetTextStyle}">
            <Setter Property="Text" Value="через"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Opacity" Value="0.6"/>
            <Setter Property="Margin" Value="0,0,4,0"/>
        </Style>
        
        <Style x:Key="CountdownStyle" TargetType="TextBlock" BasedOn="{StaticResource WidgetTextStyle}">
            <Setter Property="FontFamily" Value="Consolas, Courier New, monospace"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Opacity" Value="0.85"/>
        </Style>
        
        <!-- Menu item style -->
        <Style x:Key="MenuItemStyle" TargetType="Border">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#33FFFFFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="MenuTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Variable, Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        
        <Style x:Key="MenuIconStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#AAFFFFFF"/>
            <Setter Property="Width" Value="24"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="MenuSeparatorStyle" TargetType="Border">
            <Setter Property="Height" Value="1"/>
            <Setter Property="Background" Value="#33FFFFFF"/>
            <Setter Property="Margin" Value="12,4"/>
        </Style>
        
        <Style x:Key="CheckBoxStyle" TargetType="Border">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="18"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="BorderBrush" Value="#66FFFFFF"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
        
        <!-- Pulsing animation for move mode -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="MoveModeGlow"
                           Storyboard.TargetProperty="Opacity"
                           From="0.3" To="0.8" Duration="0:0:0.6"
                           AutoReverse="True"/>
        </Storyboard>
        
        <!-- Landing animation -->
        <Storyboard x:Key="LandingAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBorderScale"
                           Storyboard.TargetProperty="ScaleX"
                           From="1.05" To="1" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="MainBorderScale"
                           Storyboard.TargetProperty="ScaleY"
                           From="1.05" To="1" Duration="0:0:0.15"/>
        </Storyboard>
    </Window.Resources>
    
    <Grid>
        <Border x:Name="MainBorder"
            Background="#CC202020"
            CornerRadius="4"
            Padding="10,6"
            Margin="2"
            Height="44"
            VerticalAlignment="Center"
            RenderTransformOrigin="0.5,0.5">
        <Border.RenderTransform>
            <ScaleTransform x:Name="MainBorderScale" ScaleX="1" ScaleY="1"/>
        </Border.RenderTransform>
        <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="1" Opacity="0.3"/>
        </Border.Effect>
        
        <Grid>
            <!-- Move mode glow effect -->
            <Border x:Name="MoveModeGlow"
                    Background="Transparent"
                    BorderBrush="#4CAF50"
                    BorderThickness="2"
                    CornerRadius="4"
                    Margin="-10,-6"
                    Opacity="0"
                    IsHitTestVisible="False">
                <Border.Effect>
                    <DropShadowEffect Color="#4CAF50" BlurRadius="15" ShadowDepth="0" Opacity="0.8"/>
                </Border.Effect>
            </Border>
            
            <!-- Move mode tooltip -->
            <Border x:Name="MoveTooltip"
                    Background="#E8202020"
                    CornerRadius="4"
                    Padding="8,4"
                    VerticalAlignment="Top"
                    HorizontalAlignment="Center"
                    Margin="0,-50,0,0"
                    Visibility="Collapsed">
                <TextBlock x:Name="MoveTooltipText"
                          Text="Drag widget"
                          Foreground="#4CAF50"
                          FontSize="11"/>
            </Border>
            
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <!-- App Logo -->
                <Image Source="fajr.png" 
                       Width="28" Height="28" 
                       Margin="0,0,10,0" 
                       VerticalAlignment="Center"
                       RenderOptions.BitmapScalingMode="HighQuality"/>
                
                <!-- Two-line content -->
                <StackPanel VerticalAlignment="Center" Margin="0,-1,0,0">
                    <!-- First line: Prayer name + time -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="NextPrayerName" 
                                   Style="{StaticResource PrayerNameStyle}" 
                                   Text="Fajr"/>
                        <TextBlock x:Name="NextPrayerTime" 
                                   Style="{StaticResource TimeStyle}" 
                                   Margin="6,0,0,0"
                                   Text="05:30"/>
                    </StackPanel>
                    
                    <!-- Second line: Countdown -->
                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                        <TextBlock x:Name="CountdownLabel" Style="{StaticResource CountdownLabelStyle}" Text="in"/>
                        <TextBlock x:Name="Countdown" 
                                   Style="{StaticResource CountdownStyle}"
                                   Text="2:45:30"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
    
    <!-- Custom Popup Menu -->
    <Popup x:Name="MenuPopup" 
           Placement="Top" 
           PlacementTarget="{Binding ElementName=MainBorder}"
           StaysOpen="True"
           AllowsTransparency="True"
           PopupAnimation="Fade">
        <Border x:Name="MenuBorder"
                Background="#E8202020"
                CornerRadius="8"
                Margin="8"
                MinWidth="200"
                MouseLeftButtonDown="MenuBorder_MouseDown">
            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="4" Opacity="0.5"/>
            </Border.Effect>
            
            <StackPanel Margin="0,6">
                <!-- Settings -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuSettings_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="MenuSettingsIcon" Text="&#xE713;" Style="{StaticResource MenuIconStyle}"/>
                        <TextBlock x:Name="MenuSettingsText" Text="Settings" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
                
                <!-- Separator -->
                <Border Style="{StaticResource MenuSeparatorStyle}"/>
                
                <!-- Change Position -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuChangePosition_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="MenuChangePositionIcon" Text="&#xE8AB;" Style="{StaticResource MenuIconStyle}"/>
                        <TextBlock x:Name="MenuChangePositionText" Text="Change position" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
                
                <!-- Auto Start -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuAutoStart_Click">
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="AutoStartCheckBox" Style="{StaticResource CheckBoxStyle}">
                            <TextBlock x:Name="AutoStartCheck" 
                                       Text="&#xE73E;" 
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="12"
                                       Foreground="#4CAF50"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Visibility="Collapsed"/>
                        </Border>
                        <TextBlock x:Name="MenuAutoStartText" Text="Auto start" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
                
                <!-- Separator -->
                <Border Style="{StaticResource MenuSeparatorStyle}"/>
                
                <!-- Support Project -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuSupportProject_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="MenuSupportProjectIcon" Text="&#xE8EC;" Style="{StaticResource MenuIconStyle}"/>
                        <TextBlock x:Name="MenuSupportProjectText" Text="Support the project" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
                
                <!-- About -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuAbout_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="MenuAboutIcon" Text="&#xE946;" Style="{StaticResource MenuIconStyle}"/>
                        <TextBlock x:Name="MenuAboutText" Text="About" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
                
                <!-- Separator -->
                <Border Style="{StaticResource MenuSeparatorStyle}"/>
                
                <!-- Exit -->
                <Border Style="{StaticResource MenuItemStyle}" MouseLeftButtonUp="MenuExit_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="MenuExitIcon" Text="&#xE7E8;" Style="{StaticResource MenuIconStyle}"/>
                        <TextBlock x:Name="MenuExitText" Text="Exit" Style="{StaticResource MenuTextStyle}"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
    </Popup>
    </Grid>
</Window>
